<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
</head>

<body>
  <h1>Midreciever</h1>

</body>

<script>
  var timestamp = Date.now(); // Get current timestamp in milliseconds
  
  localStorage.setItem("timestamp", timestamp);
  var currenttime = localStorage.getItem("timestamp");
  //console.log(currenttime);



  var currentuser = localStorage.getItem("username");
  //console.log(currentuser);








  var currentUser = currentuser; // Replace with your actual value


  fetch("https://api.jsonbin.io/v3/b/649abd74b89b1e2299b5e114")
    .then(function(response) {
      return response.json();
    })
    .then(function(jsonData) {
      // Find the user in the JSON data
      var users = jsonData.record.users;
      var user = users.find(function(item) {
        return item.user === currentUser;
      });

      // Check if the user was found
      if (user) {
        //console.log("Reference: " + user.reference);
        userlink(user);
      } else {
        defaultuserlink()
      }
    })

    .catch(function(error) {
      //console.log("Error fetching JSON: " + error);
    });







  function userlink(user) {
    var nextlink = user.reference;
    //console.log(nextlink);

    var nextfalse = user.false;
    localStorage.setItem("nextfalse", nextfalse);



    //window.location=nextlink;
    //window.open( nextlink , "_blank");
    window.location.href = nextlink;
  }




  function defaultuserlink() {
    var nextlink = "https://sites.google.com/view/osmmoviz-co/osmmoviz";
    //console.log(nextlink);

    var nextfalse = "https://sites.google.com/view/osmmoviz-co/osmmovizfalse";
    localStorage.setItem("nextfalse", nextfalse);
    //window.location=nextlink;
    //window.open( nextlink , "_blank");
    window.location.href = nextlink;
  };
</script>

</html>
